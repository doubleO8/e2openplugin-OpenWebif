$.fx.speeds._default=1E3;var theme="original",loadspinner="<div id='spinner'><div class='fa fa-spinner fa-spin'></div></div>",mutestatus=0,lastcontenturl=null,screenshotMode="all",MessageAnswerCounter=0,shiftbutton=!1,grabTimer=0,at2add=null,_location=[],_tags=[],current_ref=null,current_name=null;
$(function(){SetSpinner();try{$("#dialog").dialog({autoOpen:!1,show:"fade",hide:"explode",buttons:{Ok:function(){$(this).dialog("close")}}}),$("#volume-indicator").click(function(){0===mutestatus?(mutestatus=1,$("#volume-indicator").toggleClass("volume_mute",!0)):(mutestatus=0,$("#volume-indicator").toggleClass("volume_mute",!1));$.ajax("web/vol?set=mute")}),getStatusInfo(),setInterval("getStatusInfo()",15E3),$("#slider").slider({range:"min",min:0,max:100,value:40,slide:function(a,c){$("#amount").val(c.value)},
stop:function(a,c){0==c.value?$("#volume-indicator").toggleClass("volume_mute",!0):$("#volume-indicator").toggleClass("volume_mute",!1);$.ajax("web/vol?set=set"+c.value);return!1}}),$("#amount").val($("#slider").slider("value")),$(".epgsearch button:first").button({icons:{primary:"ui-icon-search"}}),_locations=loadLocations(),_tags=loadTags()}catch(a){}});
(function(a){var b={height:500,width:500,toolbar:!1,scrollbars:!1,status:!1,resizable:!1,left:0,top:0,center:!0,createNew:!0,location:!1,menubar:!1,onUnload:null};a.popupWindow=function(c,d){var e=a.extend({},b,d);e.center&&(e.top=(screen.height-e.height)/2-50,e.left=(screen.width-e.width)/2);var f=[];f.push("location="+(e.location?"yes":"no"));f.push("menubar="+(e.menubar?"yes":"no"));f.push("toolbar="+(e.toolbar?"yes":"no"));f.push("scrollbars="+(e.scrollbars?"yes":"no"));f.push("status="+(e.status?
"yes":"no"));f.push("resizable="+(e.resizable?"yes":"no"));f.push("height="+e.height);f.push("width="+e.width);f.push("left="+e.left);f.push("top="+e.top);var g=(new Date).getTime(),h=window.open(c,e.createNew?"popup_window_"+g:"popup_window",f.join(","));if(e.onUnload&&"function"===typeof e.onUnload)var k=setInterval(function(){if(!h||h.closed)clearInterval(k),e.onUnload()},250);h&&h.focus&&h.focus();return h}})(jQuery);
function initJsTranslation(a){tstr_add_timer=a.add_timer;tstr_cancel=a.cancel;tstr_close=a.close;tstr_del_timer=a.delete_timer_question;tstr_del_autotimer=a.at_delete_autotimer_question;tstr_del_recording=a.delete_recording_question;tstr_ren_recording=a.rename_recording_question;tstr_done=a.done;tstr_edit_timer=a.edit_timer;tstr_hour=a.hour;tstr_save=a.save;tstr_minute=a.minute;tstr_nothing_play=a.nothing_play;tstr_now=a.now;tstr_on=a.on;tstr_reboot_box=a.reboot_box;tstr_rec_status=a.rec_status;tstr_restart_gui=
a.restart_gui;tstr_standby=a.standby;tstr_start_after_end=a.start_after_end;tstr_time=a.time;tstr_zap_to=a.zap_to;tstr_january=a.month_01;tstr_february=a.month_02;tstr_march=a.month_03;tstr_april=a.month_04;tstr_may=a.month_05;tstr_june=a.month_06;tstr_july=a.month_07;tstr_august=a.month_08;tstr_september=a.month_09;tstr_october=a.month_10;tstr_november=a.month_11;tstr_december=a.month_12;tstr_monday=a.monday;tstr_tuesday=a.tuesday;tstr_wednesday=a.wednesday;tstr_thursday=a.thursday;tstr_friday=a.friday;
tstr_saturday=a.saturday;tstr_sunday=a.sunday;tstr_mo=a.mo;tstr_tu=a.tu;tstr_we=a.we;tstr_th=a.th;tstr_fr=a.fr;tstr_sa=a.sa;tstr_su=a.su;tstr_loading=a.loading;tstr_stream=a.stream;tstr_transcoded=a.transcoded;tstr_send_message=a.send_message;tstr_sent_wait=a.sent_wait;tstr_epgsearch=a.epgsearch;tstr_bqe_del_channel_question=a.bqe_del_channel_question;tstr_bqe_del_bouquet_question=a.bqe_del_bouquet_question;tstr_bqe_name_bouquet=a.bqe_name_bouquet;tstr_bqe_name_marker=a.bqe_name_marker;tstr_bqe_rename_bouquet=
a.bqe_rename_bouquet;tstr_bqe_rename_marker=a.bqe_rename_marker;tstr_bqe_filename=a.bqe_filename;tstr_bqe_restore_question=a.bqe_restore_question;tstr_timer=a.timer;tstr_timerlist=a.timer_list;tstr_timerpreview=a.timer_preview;tstr_timernewname=a.timer_newname;tstr_open_in_new_window=a.open_in_new_window;tstr_error_load_page=a.tstr_error_load_page;tstr_timer_added=a.tstr_timer_added;tstr_event_not_found=a.tstr_event_not_found;tstr_channel=a.channel;tstr_end=a.begin;tstr_begin=a.end}
function wait_for_openwebif(){var a=window.setInterval(function(){webapi_execute("/api/statusinfo",function(){window.clearInterval(a);$("#modaldialog").dialog("close");location.reload()})},2E3)}
function handle_power_state_dialog(a){var b=0,c=loadspinner.replace("'spinner'","'spinner1'");$("#modaldialog").dialog("close");2===a?(load_reboot_dialog(c,tstr_reboot_box),wait_for_openwebif(),b=1E3):3===a&&(load_reboot_dialog(c,tstr_restart_gui),wait_for_openwebif(),b=1E3);setTimeout(function(){webapi_execute("api/powerstate?newstate="+a)},b)}
function load_reboot_dialog(a,b){$("#modaldialog").html(a).dialog({modal:!0,title:b,autoOpen:!0,width:"auto",height:"auto",open:function(a,b){$("#modaldialog").css("overflow","hidden")},close:function(a,b){$(this).dialog("destroy");$("#modaldialog").html("")}})}
function load_dm_spinner(a,b,c,d,e){var f="auto",g="auto";"undefined"!==typeof c&&(f=c);"undefined"!==typeof d&&(g=d);$("#modaldialog").html(loadspinner).dialog({modal:!0,title:b,autoOpen:!0,width:f,height:g,buttons:e,create:function(a,b){$(a.target).parent().css("position","fixed")},close:function(a,b){$(this).dialog("destroy");$("#modaldialog").html("")},open:function(){$.ajax({url:a,success:function(a){$("#modaldialog").html(a)},error:function(){$("#modaldialog").html(tstr_error_load_page)}});
$(this).siblings(".ui-dialog-buttonpane").find("button:eq(0)").focus()}})}
function load_dm(a,b,c,d){var e={};e[tstr_close]=function(){$(this).dialog("close")};var f="auto",g="auto";"undefined"!==typeof c&&(f=c);"undefined"!==typeof d&&(g=d);$.ajax({url:a,success:function(a){$("#modaldialog").html(a).dialog({modal:!0,title:b,autoOpen:!0,width:f,height:g,buttons:e,close:function(a,b){$(this).dialog("destroy");$("#modaldialog").html("")},open:function(){$(this).siblings(".ui-dialog-buttonpane").find("button:eq(0)").focus()}})},error:function(){alert(tstr_error_load_page)}})}
function load_message_dm(a,b){var c={};c[tstr_send_message]=function(){sendMessage()};c[tstr_cancel]=function(){$(this).dialog("close")};$.ajax({url:a,success:function(a){$("#modaldialog").html(a).dialog({modal:!0,title:b,autoOpen:!0,width:"auto",buttons:c,close:function(a,b){$(this).dialog("destroy");$("#modaldialog").html("")}})}})}function dialog_notyet(){$("#dialog").dialog("open");return!1}function load_tvcontent(a){$("#tvcontent").load(a);return!1}
function load_tvcontent_spin(a){$("#tvcontent").html(loadspinner).load(a);return!1}function load_maincontent(a){if(lastcontenturl!=a||-1<a.indexOf("screenshot")||-1<a.indexOf("timer")||-1<a.indexOf("boxinfo"))$("#content_container").load(a),lastcontenturl=a;return!1}function load_maincontent_spin(a){if(lastcontenturl!=a){var b='<div id="content_main" style="min-height: 500px;">'+loadspinner+"</div>";$("#content_container").html(b).load(a);lastcontenturl=a}return!1}
function webapi_execute(a,b){$.ajax({url:a,cache:!1}).done(function(){"undefined"!==typeof b&&b()});return!1}function toggle_chan_des(a,b,c){a="ajax/eventdescription?sref="+escape(b)+"&idev="+a;c="#"+c;$(c).load(a);$(c).slideToggle(200)}
function open_epg_dialog(a,b){var c="ajax/epgdialog?sref="+escape(a),d=$(window).width()-100,e=$(window).height()-100,f={};f[tstr_close]=function(){$(this).dialog("close")};f[tstr_open_in_new_window]=function(){$(this).dialog("close");open_epg_pop(a)};load_dm_spinner(c,b,d,e,f)}
function open_epg_search_dialog(){var a=$("#epgSearch").val(),b=GetLSValue("epgsearchtype",!1)?"&full=1":"",c=GetLSValue("epgsearchbouquetsonly",!1)?"&bouquetsonly=1":"",c="ajax/epgdialog?sstr="+encodeURIComponent(a)+b+c;$("#epgSearch").val("");var d=$(window).width()-100,e=$(window).height()-100,f={};f[tstr_close]=function(){$(this).dialog("close")};f[tstr_open_in_new_window]=function(){$(this).dialog("close");open_epg_search_pop(a,b)};load_dm_spinner(c,tstr_epgsearch,d,e,f)}
function _epg_pop(a){$.popupWindow(a,{height:$(window).height(),width:$(window).width(),toolbar:!1,scrollbars:!0})}function open_epg_search_pop(a,b){_epg_pop("ajax/epgpop?sstr="+encodeURIComponent(a)+b)}function open_epg_pop(a){_epg_pop("ajax/epgpop?sref="+escape(a))}
function TimerConflict(a,b,c,d){var e="<div class='tbltc'><div><div>Name</div><div>"+tstr_channel+"</div><div>"+tstr_end+"</div><div>"+tstr_begin+"</div></div>";a.forEach(function(a){e+="<div><div>"+a.name+"</div><div>"+a.servicename+"</div><div>"+a.realbegin+"</div><div>"+a.realend+"</div></div>"});e+="</div>";a={};a[tstr_close]=function(){$(this).dialog("close")};$("<div></div>").dialog({modal:!0,height:500,width:600,autoOpen:!0,title:"Timer Conflicts",open:function(){$(this).html(e)},buttons:a})}
function webapi_execute_result(a,b){$.ajax({url:a,cache:!1,success:function(a){result=json_dammit(a);"undefined"!==typeof b&&(result?b(result.result,result.message,result.conflicts):b(!1,"error"))}})}function cbAddTimerEvent(a){a.state&&($(".event[data-id="+a.eventId+'][data-ref="'+a.sRef+'"] .timer').remove(),$(".event[data-id="+a.eventId+'][data-ref="'+a.sRef+'"] div:first').append('<div class="timer">'+tstr_timer+"</div>"))}
function addTimerEvent(a,b,c,d){var e="/api/timeraddbyeventid?sRef="+a+"&eventid="+b;c&&(e+="&eit=0&disabled=0&justplay=1&afterevent=3");webapi_execute_result(e,function(e,g,h){!e&&h?TimerConflict(h,a,b,c):"undefined"!==typeof d?d({sRef:a,eventId:b,justplay:c,state:e,txt:g}):alert(e?tstr_timer_added:g)})}
function addEditTimerEvent(a,b){$.ajax({url:"/api/event?sref="+a+"&idev="+b,dataType:"json",success:function(a){"undefined"!==typeof a&&"undefined"!==typeof a.event?addTimer(a.event):alert(tstr_event_not_found)},error:function(a){}})}function htmlEscape(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}
function addAutoTimerEvent(a,b,c,d,e){at2add={name:htmlEscape(c),from:d,to:e,sref:a,sname:b};lastcontenturl="";$("#compressmepg").is(":visible")&&CompressMEPG();$("#modaldialog").hasClass("ui-dialog-content")&&($("#modaldialog").dialog("destroy"),$("#modaldialog").html(""));$("#eventdescription").hasClass("ui-dialog-content")&&($("#eventdescription").dialog("destroy"),$("#eventdescription").html(""));load_maincontent("ajax/at")}
function delTimerEvent(a,b){$.ajax({url:"/api/event?sref="+a+"&idev="+b,dataType:"json",success:function(c){if("undefined"!==typeof c&&"undefined"!==typeof c.event){var d=c.event.begin-60*c.event.recording_margin_before,e=c.event.begin+c.event.duration+60*c.event.recording_margin_after;c=decodeURIComponent(c.event.title);!0===confirm(tstr_del_timer+": "+c)&&webapi_execute("/api/timerdelete?sRef="+a+"&begin="+d+"&end="+e,function(){$(".event[data-id="+b+"] .timer").remove()})}else alert(tstr_event_not_found)},
error:function(a){}})}function toggleTimerStatus(a,b,c){$.ajax({url:"/api/timertogglestatus?",dataType:"json",data:{sRef:a,begin:b,end:c},success:function(d){$("#img-"+b+"-"+c+" > i").each(function(){$(this).data("ref")==a&&($(this).removeClass("fa-square-o"),$(this).removeClass("fa-check-square-o"),$(this).addClass(d.disabled?"fa-square-o":"fa-check-square-o"))})},error:function(a){}})}
function deleteTimer(a,b,c,d){d=decodeURIComponent(d);!0===confirm(tstr_del_timer+": "+d)&&webapi_execute("/api/timerdelete?sRef="+a+"&begin="+b+"&end="+c,function(){$("#"+b+"-"+c).remove()})}function cleanupTimer(){webapi_execute("/api/timercleanup",function(){load_maincontent("/ajax/timers")})}function webapi_execute_movie(a,b){$.ajax({url:a,cache:!1,success:function(a){if(result=json_dammit(a))result.result||alert(result.message),"undefined"!==typeof b&&b(result.result)}})}
function renameMovie(a,b){var c=prompt(tstr_ren_recording,b);c&&c!=b&&webapi_execute_movie("/api/movierename?sRef="+a+"&newname="+c)}function deleteMovie(a,b,c){!0===confirm(tstr_del_recording+": "+c)&&webapi_execute_movie("/api/moviedelete?sRef="+a,function(a){a&&$("#"+b).remove()})}function playRecording(a){a=a.replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\//g,"%2F");console.debug(a);webapi_execute("/api/zap?sRef="+a,function(){$("#osd").html(" ");$("#osd_bottom").html(" ")})}
function zapChannel(a,b){var c="/api/zap?sRef="+escape(a);webapi_execute(c,function(){$("#osd").html(tstr_zap_to+": "+b);$("#osd_bottom").html(" ")})}function toggleStandby(){webapi_execute("api/powerstate?newstate=0"+(shiftbutton?"&shift=1":""));setTimeout(getStatusInfo,1500)}
function setOSD(a){var b=current_ref=a.currservice_serviceref,c=current_name=a.currservice_station;if(c){var d="<div id='osdicon'>",e=tstr_stream+": "+c+"'><i class='fa fa-desktop'></i></a>",f=tstr_stream+" ("+tstr_transcoded+"): "+c+"'><i class='fa fa-mobile'></i></a>",g="<span class='osdch'>"+c+"</span></a>&nbsp;&nbsp;"+a.currservice_begin+" - "+a.currservice_end+"&nbsp;&nbsp;";-1!==b.indexOf("1:0:1")||-1!==b.indexOf("1:134:1")?(d=a.transcoding?d+("<a href='#' onclick=\"jumper8001('"+b+"', '"+c+
"')\"; title='"+e)+("<a href='#' onclick=\"jumper8002('"+b+"', '"+c+"')\"; title='"+f):d+("<a target='_blank' href='/web/stream.m3u?ref="+b+"&name="+c+"' title='"+e),d+="</div>",$("#osd").html(d+"<a href='#' onClick='load_maincontent(\"ajax/tv\");return false;'>"+g+"<a style='text-decoration:none;' href=\"#\" onclick=\"open_epg_pop('"+b+"')\" title='"+a.currservice_fulldescription+"'>"+a.currservice_name+"</a>")):-1!==b.indexOf("1:0:2")||-1!==b.indexOf("1:134:2")?(d+="<a target='_blank' href='/web/stream.m3u?ref="+
b+"&name="+c+"' title='"+e,d+="</div>",$("#osd").html(d+"<a href='#' onClick='load_maincontent(\"ajax/radio\");return false;'>"+g+"<a style='text-decoration:none;' href=\"#\" onclick=\"open_epg_pop('"+b+"')\" title='"+a.currservice_fulldescription+"'>"+a.currservice_name+"</a>")):-1!==b.indexOf("1:0:0")?(a.transcoding?(d+="<a href='#' onclick=\"jumper80('"+a.currservice_filename+"')\"; title='"+e,d+="<a href='#' onclick=\"jumper8003('"+a.currservice_filename+"')\"; title='"+f):d+="<a target='_blank' href='/web/ts.m3u?file="+
a.currservice_filename+"' title='"+e,d+="</div>",$("#osd").html(d+g+a.currservice_name)):$("#osd").html(g+a.currservice_name);$("#osd_bottom").html(a.currservice_description)}else $("#osd").html(tstr_nothing_play),$("#osd_bottom").html("")}
function getStatusInfo(){$.ajax({url:"/api/statusinfo",dataType:"json",cache:!1,success:function(a){$("#slider").slider("value",a.volume);$("#amount").val(a.volume);!0==a.muted?(mutestatus=1,$("#volume-indicator").toggleClass("volume_mute",!0)):(mutestatus=0,$("#volume-indicator").toggleClass("volume_mute",!1));setOSD(a);var b=$("#osd_status");0==b.length&&($("body").append('<div id="osd_status"></div>'),b=$("#osd_status"));var c=$("#recording-indicator");0==c.length&&(b.append('<div id="recording-indicator" class="led-box"><div class="led led-red"></div></div>'),
c=$("#recording-indicator"));c.off();c.toggleClass("is_recording",a.state.recording);c.on("click",function(a){a.preventDefault();load_maincontent("ajax/timers")});c=$("#standby-indicator");0==c.length&&(b.append('<div id="standby-indicator" class="standby_image">&nbsp;</div>'),c=$("#standby-indicator"));c.off();c.toggleClass("in_standby",a.state.standby);c.on("click",function(a){a.preventDefault();toggleStandby()})},error:function(){$("#osd, #osd_bottom").html("")}})}
function grabScreenshot(a){$("#screenshotspinner").show();$("#screenshotimage").load(function(){$("#screenshotspinner").hide()});"auto"!=a?screenshotMode=a:a=screenshotMode;timestamp=(new Date).getTime();GetLSValue("ssr_hd",!1)?$("#screenshotimage").attr("src","/grab?format=jpg&mode="+a+"#"+timestamp):$("#screenshotimage").attr("src","/grab?format=jpg&r=720&mode="+a+"#"+timestamp);$("#screenshotimage").attr("width",720)}
function getMessageAnswer(){$.ajax({url:"/api/messageanswer",dataType:"json",cache:!1,success:function(a){$("#messageSentResponse").html(a.message)}})}function countdowngetMessage(){MessageAnswerCounter--;3>MessageAnswerCounter?getMessageAnswer():($("#messageSentResponse").html(tstr_sent_wait+" "+MessageAnswerCounter),setTimeout(countdowngetMessage,1E3))}
function sendMessage(){var a=$("#messageText").val(),b=$("#messageType").val(),c=$("#messageTimeout").val();$.ajax({url:"/api/message?text="+a+"&type="+b+"&timeout="+c,dataType:"json",cache:!1,success:function(a){$("#messageSentResponse").html(a.message);0==b&&(MessageAnswerCounter=c,setTimeout(countdowngetMessage,1E3))}})}
function toggleMenu(a){var b="#leftmenu_expander_"+a,c="#leftmenu_container_"+a;$(b).hasClass("ui-icon-caret-1-w")?($(b).removeClass("ui-icon-caret-1-w"),$(b).addClass("ui-icon-caret-1-s"),$(c).show("fast"),webapi_execute("/api/expandmenu?name="+a)):($(b).addClass("ui-icon-caret-1-w"),$(b).removeClass("ui-icon-caret-1-s"),$(c).hide("fast"),webapi_execute("/api/collapsemenu?name="+a))}
$(function(){$(".remotegrabscreen").click(function(a){$(".remotegrabscreen").prop("checked",a.currentTarget.checked);SetLSValue("remotegrabscreen",a.currentTarget.checked)});$(".remotegrabscreen").prop("checked",GetLSValue("remotegrabscreen",!0));$("input[name=epgsearchtype]").click(function(a){$("input[name=epgsearchtype]").prop("checked",a.currentTarget.checked);SetLSValue("epgsearchtype",a.currentTarget.checked)});"undefined"!==typeof $("input[name=epgsearchtype]")?$("input[name=epgsearchtype]").prop("checked",
GetLSValue("epgsearchtype",!1)):SetLSValue("epgsearchtype",!1);$("input[name=epgsearchbouquetsonly]").click(function(a){$("input[name=epgsearchbouquetsonly]").prop("checked",a.currentTarget.checked);SetLSValue("epgsearchbouquetsonly",a.currentTarget.checked)});"undefined"!==typeof $("input[name=epgsearchbouquetsonly]")?$("input[name=epgsearchbouquetsonly]").prop("checked",GetLSValue("epgsearchbouquetsonly",!1)):SetLSValue("epgsearchbouquetsonly",!1)});
$(window).keydown(function(a){16==a.which&&(shiftbutton=!0)}).keyup(function(a){16==a.which&&(shiftbutton=!1)});function callScreenShot(){GetLSValue("remotegrabscreen",!0)&&("ajax/screenshot"==lastcontenturl?grabScreenshot(screenshotMode):load_maincontent("ajax/screenshot"))}function pressMenuRemote(a){webapi_execute("/api/remotecontrol?"+(shiftbutton?"type=long&":"")+"command="+a);0<grabTimer&&clearTimeout(grabTimer);grabTimer=setTimeout("callScreenShot()",1<a&&12>a?1500:1E3)}
function toggleFullRemote(){$("#menucontainer").toggle();$("#remotecontainer").toggle()}function saveConfig(a,b){$.ajax({url:"/api/saveconfig?key="+escape(a)+"&value="+escape(b),cache:!1,type:"POST"}).done(function(){"config.usage.setup_level"==a&&$("#content_container").load(lastcontenturl)})}function numberTextboxKeydownFilter(a){46==a.keyCode||(8==a.keyCode||9==a.keyCode)||(48>a.keyCode||57<a.keyCode)&&(96>a.keyCode||105<a.keyCode)&&a.preventDefault()}
var current_serviceref,current_begin,current_end,timeredit_initialized=!1,timeredit_begindestroy=!1;function initTimerBQ(a,b){$("#bouquet_select").find("optgroup").remove().end();$("#bouquet_select").find("option").remove().end();GetAllServices(function(a,d){$("#bouquet_select").append(a);current_ref&&$("#bouquet_select").val(current_ref);$("#bouquet_select").trigger("chosen:updated");b()},a)}
function initTimerEdit(a,b){initTimerBQ(a,function(){$("#dirname").find("option").remove().end();$("#dirname").append($("<option></option>").attr("value","None").text("Default"));for(var a in _locations){var d=_locations[a];$("#dirname").append($("<option></option>").attr("value",d).text(d))}$("#tagsnew").html("");for(a in _tags)d=_tags[a],$("#tagsnew").append("<input type='checkbox' name='"+d+"' value='"+d+"' id='tag_"+d+"'/><label for='tag_"+d+"'>"+d+"</label>");$("#tagsnew > input").checkboxradio({icon:!1});
timeredit_initialized=!0;b()})}function loadLocations(){_locations=[];$.ajax({url:"/api/getlocations",success:function(a){a=json_dammit(a);a.result&&(_locations=a.locations)}})}function loadTags(){_tags=[];$.ajax({url:"/api/gettags",success:function(a){a=json_dammit(a);a.result&&(_tags=a.tags)}})}function checkVPS(){$("#vpsplugin_enabled").is(":checked")?($("#vpsplugin_safemode").show(),$("#has_vpsplugin2").show()):($("#vpsplugin_safemode").hide(),$("#has_vpsplugin2").hide())}
function initTimerEditBegin(){$("#timerbegin").datetimepicker({timeText:tstr_time,hourText:tstr_hour,minuteText:tstr_minute,currentText:tstr_now,closeText:tstr_done,monthNames:[tstr_january,tstr_february,tstr_march,tstr_april,tstr_may,tstr_june,tstr_july,tstr_august,tstr_september,tstr_october,tstr_november,tstr_december],dayNames:[tstr_sunday,tstr_monday,tstr_tuesday,tstr_wednesday,tstr_thursday,tstr_friday,tstr_saturday,tstr_sunday],dayNamesMin:[tstr_su,tstr_mo,tstr_tu,tstr_we,tstr_th,tstr_fr,tstr_sa,
tstr_su],dateFormat:"dd.mm.yy",timeFormat:"HH:mm",onClose:function(a,b){""!=$("#timerend").val()&&$(this).datetimepicker("getDate")>$("#timerend").datetimepicker("getDate")?($("#error").text(tstr_start_after_end),$("#errorbox").show()):$("#errorbox").hide()}})}function json_dammit(a){var b=null;try{b=$.parseJSON(a)}catch(c){b=a}return b}
function editTimer(a,b,c){current_serviceref=a=decodeURI(a);current_begin=b;current_end=c;var d=!1;"undefined"!==typeof a&&(d="1:0:2:"==a.substring(0,6));$("#cbtv").prop("checked",!d);$("#cbradio").prop("checked",d);var e=function(){timeredit_begindestroy&&(initTimerEditBegin(),timeredit_begindestroy=!1);$.ajax({url:"/api/timerlist",success:function(d){timers=json_dammit(d);if(timers.result)for(var e in timers.timers)if(timer=timers.timers[e],timer.serviceref==a&&Math.round(timer.begin)==Math.round(b)&&
Math.round(timer.end)==Math.round(c)){$("#timername").val(timer.name);$("#description").val(timer.description);$("#bouquet_select").val(timer.serviceref);$("#bouquet_select").trigger("chosen:updated");timer.serviceref!==$("#bouquet_select").val()&&($("#bouquet_select").append($("<option></option>").attr("value",timer.serviceref).text(timer.servicename)),$("#bouquet_select").val(timer.serviceref));$("#dirname").val(timer.dirname);timer.dirname!==$("#dirname").val()&&(current_location="<option value='"+
timer.dirname+"'>"+timer.dirname+"</option>",$("#dirname").append(current_location),$("#dirname").val(timer.dirname));$("#enabled").prop("checked",0==timer.disabled);$("#justplay").prop("checked",timer.justplay);$("#afterevent").val(timer.afterevent);$("#errorbox").hide();d=timer.repeated;for(e=0;7>e;e++)$("#day"+e).prop("checked",1==(d&1)).checkboxradio("refresh"),d>>=1;$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");d=timer.tags.split(" ");for(e=0;e<d.length;e++){var f=d[e].replace(/\(/g,
"_").replace(/\)/g,"_").replace(/\'/g,"_");0<f.length&&($("#tag_"+f).length?$("#tag_"+f).prop("checked",!0).checkboxradio("refresh"):$("#tagsnew").append("<input type='checkbox' checked='checked' name='"+f+"' value='"+f+"' id='tag_"+f+"'/><label for='tag_"+f+"'>"+f+"</label>"))}$("#tagsnew > input").checkboxradio({icon:!1});$("#timerbegin").datetimepicker("setDate",new Date(1E3*Math.round(timer.begin)));$("#timerend").datetimepicker("setDate",new Date(1E3*Math.round(timer.end)));(d=2===timer.state)?
($("#timerbegin").datetimepicker("destroy"),timeredit_begindestroy=!0,$("#timerbegin").addClass("ui-state-disabled"),$("#timername").addClass("ui-state-disabled"),$("#dirname option").not(":selected").attr("disabled","disabled"),$("#bouquet_select option").not(":selected").attr("disabled","disabled")):($("#timername").removeClass("ui-state-disabled"),$("#timerbegin").removeClass("ui-state-disabled"),$("#dirname option").removeAttr("disabled"),$("#bouquet_select option").removeAttr("disabled"));$("#timerbegin").prop("readonly",
d);$("#timername").prop("readonly",d);"undefined"!==typeof timer.vpsplugin_enabled?($("#vpsplugin_enabled").prop("checked",timer.vpsplugin_enabled),$("#vpsplugin_safemode").prop("checked",!timer.vpsplugin_overwrite),$("#has_vpsplugin1").show(),checkVPS()):$("#has_vpsplugin1").hide();"undefined"!==typeof timer.always_zap?($("#always_zap1").show(),$("#always_zap").prop("checked",1==timer.always_zap),$("#justplay").prop("disabled",1==timer.always_zap)):$("#always_zap1").hide();openTimerDlg(tstr_edit_timer+
" - "+timer.name);break}}})};if(timeredit_initialized){var f=$("#bouquet_select option:last").val();d&&"1:0:2:"!==f.substring(0,6)?initTimerEdit(d,e):!d&&"1:0:2:"==f.substring(0,6)?initTimerEdit(d,e):e()}else initTimerEdit(d,e)}
function addTimer(a,b,c,d){current_serviceref="";current_end=current_begin=-1;servicename="";var e=-1,f=-1,g="",h="",k="",m=0,l=0;"undefined"!==typeof a&&""!=a&&(e=a.begin,f=a.begin+a.duration,g=a.sref,servicename=a.channel,h=a.title,k=a.shortdesc,m=a.recording_margin_before,l=a.recording_margin_after);var n=$("#bouquet_select > optgroup").length;a=!1;"undefined"!==typeof b&&(a="1:0:2:"==b.substring(0,6));$("#cbtv").prop("checked",!a);$("#cbradio").prop("checked",a);d=function(){"undefined"!==typeof b&&
"undefined"!==typeof c&&(g=b,h=c,"undefined"===$("#bouquet_select").val(b)&&$("#bouquet_select").append($("<option></option>").attr("value",g).text(c)));$("#timername").val(h);$("#description").val(k);$("#dirname").val("None");$("#enabled").prop("checked",!0);$("#justplay").prop("checked",!1);$("#afterevent").val(3);$("#errorbox").hide();for(var a=0;7>a;a++)$("#day"+a).prop("checked",!1).checkboxradio("refresh");$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");a=-1!==e?new Date(1E3*
(Math.round(e)-60*m)):new Date;$("#timerbegin").datetimepicker("setDate",a);a=-1!==f?new Date(1E3*(Math.round(f)+60*l)):new Date(a.getTime()+36E5);$("#timerend").datetimepicker("setDate",a);$("#bouquet_select").val(g);$("#bouquet_select").trigger("chosen:updated");openTimerDlg(tstr_add_timer)};!timeredit_initialized||2>n?initTimerEdit(a,d):(n=$("#bouquet_select option:last").val(),a&&"1:0:2:"!==n.substring(0,6)?initTimerEdit(a,d):!a&&"1:0:2:"==n.substring(0,6)?initTimerEdit(a,d):d())}
function openTimerDlg(a){$("#editTimerForm").dialog("open");$("#editTimerForm").dialog("option","title",a)}function InitAccordeon(a){$(a).accordion({active:!0,animate:!1,activate:function(a,c){c.oldPanel.empty();c.oldPanel.html(tstr_loading+" ...");c.newPanel.load(c.newHeader.find("a").attr("id"))},heightStyle:"content",collapsible:!0})}
function RefreshMEPG(a){var b=$("#compressmepg").is(":visible"),c="",d=GetLSValue("lastmbq_"+a,"");""!=d&&(c="&bref="+d);$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+a+c,function(){b&&ExpandMEPG()})}
function ExpandMEPG(){$("#expandmepg").hide();$("#compressmepg").show();$("#refreshmepg2").show();$("#header").hide();$("#leftmenu").hide();$("#content").css("margin-left","5px");$("#tvcontentmain > #toolbar-header").hide();$("#tbl1body").height("100%");$("#tvcontent").css("height","100%");$("#tvcontentmain").css("height","950px");fixTableHeight()}
function CompressMEPG(){$("#refreshmepg").show();$("#expandmepg").show();$("#compressmepg").hide();$("#refreshmepg").show();$("#refreshmepg2").hide();$("#header").show();$("#leftmenu").show();$("#content").css("margin-left","185px");$("#tvcontentmain > #toolbar-header").show();$("#tvcontent").css("height","730px");$("#tvcontentmain").css("height","800px");fixTableHeight()}
function mainresize(){console.log("WH"+$(window).height()+"TVH"+$("#tvcontentmain").height());if($("#tvcontentmain"))try{fixTableHeight()}catch(a){}}var mepgdirect=0;
function InitTVRadio(a){var b="radio"==a?"?stype=radio":"";$("#btn0").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/current"+b)});$("#btn5").click(function(){var b="",c=GetLSValue("lastmbq_"+a,"");""!=c&&(b="&bref="+c);$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+a+b);$("#expandmepg").show();$("#refreshmepg").show()});$("#btn1").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/bouquets"+
b)});$("#btn2").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/providers"+b)});$("#btn3").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").load("ajax/satellites"+b)});$("#btn4").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/channels"+b)});$("#tvbutton").buttonset();if(!0===tv){var c=window.location.href.toLowerCase().split("#");window.location.hash=
"";if("tv"==c[1]){if("mepg"==c[2]||"mepgfull"==c[2]){mepgdirect=0;"mepgfull"==c[2]&&(mepgdirect=1);$("#btn5").click();return}if("current"==c[2]){$("#btn0").click();return}}}$("#tvcontent").load("ajax/bouquets"+b);"pepper-grinder"==theme&&$("#tvcontent").addClass("ui-state-active")}
function InitBouquets(a){var b="";!0===a?$("#btn0").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/current")}):(b="?stype=radio",$("#btn0").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/current"+b)}));$("#btn5").click(function(){var b=!0===a?"tv":"radio",c="",f=GetLSValue("lastmbq_"+b,"");""!=f&&(c="&bref="+f);$("#tvcontent").html(loadspinner).load("ajax/multiepg?epgmode="+
b+c);$("#expandmepg").show();$("#refreshmepg").show()});$("#btn1").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/bouquets"+b)});$("#btn2").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/providers"+b)});$("#btn3").click(function(){$("#expandmepg").hide();$("#refreshmepg").hide();$("#tvcontent").load("ajax/satellites"+b)});$("#btn4").click(function(){$("#expandmepg").hide();
$("#refreshmepg").hide();$("#tvcontent").html(loadspinner).load("ajax/channels"+b)});$("#tvbutton").buttonset();if(!0===a){var c=window.location.href.toLowerCase().split("#");window.location.hash="";if("tv"==c[1]){if("mepg"==c[2]||"mepgfull"==c[2]){mepgdirect=0;"mepgfull"==c[2]&&(mepgdirect=1);$("#btn5").click();return}if("current"==c[2]){$("#btn0").click();return}}}$("#tvcontent").load("ajax/bouquets"+b);"pepper-grinder"==theme&&$("#tvcontent").addClass("ui-state-active")}
function getWinSize(a){a||(a=window);var b={};"undefined"!=typeof a.innerWidth?(b.screenWidth=a.screen.width,b.screenHeight=a.screen.height):(b.screenWidth=0,b.screenHeight=0);return b}function getDeviceType(){var a=getWinSize();return 500>(a.screenHeight>a.screenWdith?a.screenHeight:a.screenWidth)?"phone":"tab"}
function getOSType(){var a=navigator.userAgent;return-1<a.indexOf("iPod")||-1<a.indexOf("iPhone")||-1<a.indexOf("iPad")||-1<a.indexOf("ipod")||-1<a.indexOf("iphone")||-1<a.indexOf("ipad")?"ios":-1<a.indexOf("Android")||-1<a.indexOf("android")?"android":-1<a.indexOf("BlackBerry")||-1<a.indexOf("blackberry")?"blackberry":"unknown"}function jumper80(a){getDeviceType();document.portFormTs.file.value=a;document.portFormTs.device.value="etc";document.portFormTs.submit()}
function jumper8003(a){getDeviceType();document.portFormTs.file.value=a;document.portFormTs.device.value="phone";document.portFormTs.submit()}function jumper8002(a,b){getDeviceType();document.portForm.ref.value=a;document.portForm.name.value=b;document.portForm.device.value="phone";document.portForm.submit()}function jumper8001(a,b){getDeviceType();document.portForm.ref.value=a;document.portForm.name.value=b;document.portForm.device.value="etc";document.portForm.submit()}
function ChangeTheme(a){$.ajax({url:"api/settheme?theme="+a,success:function(){window.location.hash="#settings";window.location.reload(!0)}})}function directlink(){var a="ajax/tv",b=window.location.href.toLowerCase().split("#")[1];switch(b){case "radio":case "movies":case "timer":case "settings":case "at":case "bqe":case "epgr":a="ajax/"+b}"tv"!=b&&(window.location.hash="");load_maincontent(a)}
function ShowTimers(a){0<a.length&&$(".ETV tbody").each(function(b){b=$(this).data("id").split(";");if(3==b.length){var c=b[0],d=parseInt(b[1]),e=d+60*parseInt(b[2]),f=$(this);a.forEach(function(a){if(a.sref==c){var b=parseInt(a.begin);a=parseInt(a.end);if(e>b&&d<a){var k=f.find(".addtimer").first(),m=f.find(".deltimer").first(),l=f.find(".timerpanel").first();d>=b&&e<=a?(k.hide(),m.show(),l.css("background-color","red")):l.css("background-color","yellow")}}})}})}var MLHelper;
(function(){"undefined"==typeof MLHelper&&(MLHelper=new function(){var a;return{Init:function(){a=this},Load:function(b){$.widget("custom.iconselectmenu",$.ui.selectmenu,{_renderItem:function(a,b){var e=$("<li>"),f=$("<div>",{text:b.label}).prepend($("<span class='sortimg'>").append($("<i>",{"class":"fa "+b.element.data("class")})));return e.append(f).appendTo(a)}});$("#moviesort").iconselectmenu({change:function(a,b){MLHelper.SortMovies(b.item.value);MLHelper.ChangeSort(b.item.value)}}).addClass("ui-menu-icons");
a.SetSortImg();a.ReadMovies()},SetSortImg:function(){$("#moviesort option").each(function(){var a="";if($(this).val()==$("#moviesort").val()&&(a=$(this).data("class")))a=$("<span class='sortimg'>").append($("<i>",{"class":"fa "+a})),$("#moviesort-button .ui-selectmenu-text").prepend(a)})},SortMovies:function(b){var c=a._movies.slice(0);"name"==b&&c.sort(function(a,b){var c=a.title.toLowerCase(),d=b.title.toLowerCase();return c<d?-1:c>d?1:0});"named"==b&&c.sort(function(a,b){var c=b.title.toLowerCase(),
d=a.title.toLowerCase();return c<d?-1:c>d?1:0});"date"==b&&c.sort(function(a,b){return a.start-b.start});"dated"==b&&c.sort(function(a,b){return b.start-a.start});$("#movies").empty();b=0;for(var d=c.length;b<d;b++)$("#movies").append(c[b].html);a.SetSortImg();return c},ChangeSort:function(a){$.ajax({url:"api/setmoviesort?nsort="+a,success:function(){}})},ReadMovies:function(){a._movies=[];$("#movies").children(".tm_row").each(function(){var b=$(this).data("start"),c=$(this).data("title");a._movies.push({id:$(this).attr("id"),
title:c,start:b,html:$(this)})})},SetMovies:function(b){a._movies=b.slice()}}},MLHelper.Init())})();function reversetheme(){return"pepper-grinder"==theme||"vader"==theme||"smoothness"==theme||"le-frog"==theme||"mint-choc"==theme||"humanity"==theme||"eggplant"==theme||"dot-luv"==theme||"black-tie"==theme}function getHoverCls(){return reversetheme()?"ui-state-active":"ui-state-hover"}function getActiveCls(){return reversetheme()?"ui-state-hover":"ui-state-active"}
function setHover(a){var b=getHoverCls();$(a).hover(function(){$(this).addClass(b)},function(){$(this).removeClass(b)})}function setTMHover(){"pepper-grinder"==theme&&($(".tm_row").removeClass("ui-state-default"),$(".tm_row").addClass("ui-state-hover"));$(".tm_row").hover(function(){$(this).addClass("ui-state-active")},function(){$(this).removeClass("ui-state-active")})}function SetLSValue(a,b){"undefined"!==typeof Storage&&localStorage.setItem(a,b)}
function GetLSValue(a,b){var c=b;if("undefined"!==typeof Storage){var d=localStorage.getItem(a);if(void 0!==d&&null!==d){if("true"===d)return!0;if("false"===d)return!1;c=d}}return c}function SetSpinner(){loadspinner="<div id='spinner'><div class='fa "+GetLSValue("spinner","fa-spinner")+" fa-spin'></div></div>"}function isInArray(a,b){return 0<=a.indexOf(b)?!0:!1}
function FillAllServices(a,b){var c="",d="",e=[];$.each(a,function(a,b){var h=b.servicename;d+="<option value='"+encodeURIComponent(b.servicereference)+"'>"+b.servicename+"</option>";var k=[];$.each(b.subservices,function(a,b){var c=b.servicereference;isInArray(e,c)||(e.push(c),"1:0:"==c.substring(0,4)&&k.push("<option value='"+c+"'>"+b.servicename+"</option>"),"1:134:1"==c.substring(0,7)&&k.push("<option value='"+encodeURIComponent(c)+"'>"+b.servicename+"</option>"))});0<k.length&&(c+="<optgroup label='"+
h+"'>"+k.join("")+"</optgroup>")});b(c,d)}
function GetAllServices(a,b){if("undefined"!==typeof a){"undefined"===typeof b&&(b=!1);var c="gas-date",d="gas-data",e="";b&&(c+="r",d+="r",e="&type=radio");var f=new Date,f=f.getFullYear()+"-"+(f.getMonth()+1)+"-"+f.getDate(),g=GetLSValue(d,"");if(g===f&&(g=GetLSValue(c,null),null!=g)){e=json_dammit(g).services;FillAllServices(e,a);return}$.ajax({url:"/api/getallservices?renameserviceforxmbc=1"+e,success:function(b){SetLSValue(c,b);SetLSValue(d,f);b=json_dammit(b).services;FillAllServices(b,a)}})}}
var SSHelperObj=function(){var a;return{setup:function(){a=this;clearInterval(a.screenshotInterval);a.ssr_i=parseInt(GetLSValue("ssr_i","30"));$("#screenshotbutton0").click(function(){grabScreenshot("all")});$("#screenshotbutton1").click(function(){grabScreenshot("video")});$("#screenshotbutton2").click(function(){grabScreenshot("osd")});$("#screenshotbutton").buttonset();$("#screenshotrefreshbutton").buttonset();$("#ssr_i").val(a.ssr_i);$("#ssr_s").prop("checked",GetLSValue("ssr_s",!1));$("#ssr_hd").prop("checked",
GetLSValue("ssr_hd",!1));$("#screenshotspinner").addClass(GetLSValue("spinner","fa-spinner"));$("#ssr_hd").change(function(){SetLSValue("ssr_hd",$("#ssr_hd").is(":checked"));grabScreenshot("auto")});$("#ssr_i").change(function(){var b=$("#ssr_i").val();SetLSValue("ssr_i",b);a.ssr_i=parseInt(b);$("#ssr_s").is(":checked")&&(clearInterval(a.screenshotInterval),a.setSInterval())});$("#ssr_s").change(function(){var b=$("#ssr_s").is(":checked");b?a.setSInterval():clearInterval(a.screenshotInterval);SetLSValue("ssr_s",
b)});screenshotMode="all";grabScreenshot(screenshotMode);GetLSValue("ssr_s",!1)&&a.setSInterval()},setSInterval:function(){a.screenshotInterval=setInterval("grabScreenshot('auto')",1E3*(a.ssr_i+1))}}},SSHelper=new SSHelperObj;
